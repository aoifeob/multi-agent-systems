agent Lightswitch {
    module Console console;
    module System s;

    types lights
    {
      formula switch(string);
      formula switch(string, string);
      formula light(string, string);
    }

    initial light("l1", "on");
    initial light("l2", "off");
    initial switch("s1", "on");

    rule +!main(list args) {
        +switch("on");
        s.sleep(1000);
        s.exit();
    }

    rule +light(string Light, string State) : light(Light, string OtherState){
      console.println("Light: " + Light + " is in state: " + State);
    }

    rule +light(string Light, string State){ }

    rule +switch(string State){
      +switch("s1", State);
    }

    rule +switch(string Switch, "on"){
      -light("l1", "off");
      +light("l1", "on");
      -light("l2", "off");
      +light("l2", "on");
    }

    rule +switch(string Switch, "off"){
      -light("l1", "on");
      +light("l1", "off");
      -light("l2", "on");
      +light("l2", "off");
    }
}
